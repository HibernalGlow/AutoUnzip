# findz - 使用 Typer 和 Rich 优化的命令行工具

## 🎉 新功能

### ✨ 交互模式

当不提供任何参数运行 `findz` 时，会自动进入交互模式：

```bash
# 直接运行进入交互模式
findz

# 或使用 -i 选项
findz -i
```

交互模式提供：
- 🎯 引导式查询构建
- 📝 预设过滤器模板
- ✅ 查询预览和确认
- 🎨 美观的 Rich UI

### 🎨 Rich 增强输出

- ✅ 彩色输出
- ✅ 进度指示器（搜索文件时）
- ✅ 美观的面板和表格
- ✅ Markdown 格式的帮助文档

### ⚡ Typer CLI

- 更好的参数解析
- 自动生成帮助文档
- 类型安全
- 更友好的错误提示

## 📖 使用方法

### 命令行模式

```bash
# 基本搜索
findz 'size > 10M'

# 指定路径
findz 'ext = "py"' /path/to/search

# 长列表格式
findz 'date = today' -l

# CSV 输出
findz 'type = "file"' --csv

# 显示帮助
findz --help
findz -H  # 显示 WHERE 语法帮助
```

### 交互模式

```bash
findz
```

交互模式会引导你完成以下步骤：

1. **选择搜索路径**
   ```
   Search path: [.]
   ```

2. **选择过滤器类型**
   ```
   1. Size filter      - 按文件大小过滤
   2. Name filter      - 按文件名过滤
   3. Date filter      - 按修改日期过滤
   4. Extension filter - 按扩展名过滤
   5. Type filter      - 按文件类型过滤
   6. Archive filter   - 按压缩包类型过滤
   7. Custom filter    - 自定义 WHERE 子句
   ```

3. **配置过滤参数**
   - 根据所选类型，交互式输入参数
   - 例如：大小、名称模式、日期范围等

4. **选择输出选项**
   ```
   Use long listing format? [y/N]
   Output as CSV? [y/N]
   Follow symbolic links? [y/N]
   ```

5. **查看并执行**
   - 显示查询摘要
   - 确认后执行搜索
   - 实时显示进度

## 🎯 交互模式示例

### 示例 1: 查找大文件

```
findz

# 交互式输入：
Search path: /home/user
Choose filter type: 1 (Size filter)
Operator: >
Size: 100M
Use long listing format? y
Output as CSV? n
Follow symbolic links? n

# 生成的查询：
WHERE: size > 100M
Path: /home/user
```

### 示例 2: 查找 Python 文件

```
findz

# 交互式输入：
Search path: .
Choose filter type: 4 (Extension filter)
Extensions: py,pyi
Use long listing format? n
Output as CSV? y

# 生成的查询：
WHERE: ext in ("py", "pyi")
Path: .
```

### 示例 3: 查找今天修改的文件

```
findz

# 交互式输入：
Search path: /var/log
Choose filter type: 3 (Date filter)
Date type: today
Use long listing format? y

# 生成的查询：
WHERE: date = today
Path: /var/log
```

## 🔧 命令行选项

```
Usage: findz [OPTIONS] [WHERE] [PATHS]...

Arguments:
  WHERE      SQL WHERE-like filter expression
  PATHS      Paths to search (default: current directory)

Options:
  -H, --filter-help          Show WHERE filter syntax help
  -l, --long                Show long listing format
  --csv                     Output as CSV with header
  --csv-no-head             Output as CSV without header
  --archive-separator TEXT  Separator between archive and file [default: //]
  -L, --follow-symlinks     Follow symbolic links
  -n, --no-archive         Disable archive support
  -0, --print0             Use null character instead of newline
  -V, --version            Show version information
  -i, --interactive        Enter interactive mode
  --help                   Show this help message
```

## 💡 快速示例

### 命令行模式

```bash
# 查找大文件
findz 'size > 100M' -l

# 查找 Python 文件
findz 'ext in ("py", "pyi")'

# 查找今天修改的日志
findz 'ext = "log" and date = today' /var/log

# 在压缩包中搜索
findz 'archive = "zip" and size < 1M'

# 复杂查询
findz '(name like "test%" or name like "%_test.py") and date >= mo'
```

### 交互模式快捷操作

按照提示一步步输入，系统会自动生成正确的 WHERE 子句。

## 🎨 Rich UI 特性

### 搜索时的进度指示

```
⠋ Searching files...
```

### 彩色输出

- **错误**: 红色加粗
- **成功**: 青色
- **信息**: 默认颜色
- **高亮**: 各种颜色标注

### 格式化面板

```
╭─────────────── Query Summary ───────────────╮
│ Search Path: /home/user                     │
│ Filter: size > 100M                         │
│ Long format: True                           │
│ CSV output: False                           │
│ Follow symlinks: False                      │
╰─────────────────────────────────────────────╯
```

### Markdown 帮助

使用 `-H` 显示格式化的帮助文档，包含：
- 语法高亮
- 代码块
- 章节标题
- 列表格式

## 📦 安装

确保安装了所有依赖：

```bash
cd /path/to/AutoUnzip
pip install -e .
```

或者只安装 findz：

```bash
cd src/findz
pip install -e .
```

## 🔍 WHERE 语法速查

### 比较运算符
```
=, !=, <>, <, >, <=, >=
```

### 逻辑运算符
```
AND, OR, NOT
```

### 模式匹配
```
LIKE    - 区分大小写 (% 匹配任意字符, _ 匹配单个字符)
ILIKE   - 不区分大小写
RLIKE   - 正则表达式
```

### 范围运算符
```
BETWEEN - 范围匹配
IN      - 列表匹配
```

### 文件属性
```
name, path, size, date, time, ext, ext2, type, archive, container
```

### 辅助属性
```
today, mo, tu, we, th, fr, sa, su
```

## 🚀 性能提示

1. **禁用压缩包扫描**（更快）：
   ```bash
   findz 'size > 1M' -n
   ```

2. **指定具体路径**而非根目录：
   ```bash
   findz 'ext = "py"' ~/projects  # 快
   findz 'ext = "py"' /           # 慢
   ```

3. **使用更精确的过滤器**：
   ```bash
   findz 'ext = "log" and size > 1M'  # 快
   findz '1'                          # 慢（匹配所有文件）
   ```

## 🎓 学习资源

- 运行 `findz -H` 查看完整的 WHERE 语法
- 运行 `findz --help` 查看所有命令行选项
- 使用 `findz -i` 进入交互模式学习语法
- 查看 `EXAMPLES.md` 获取更多示例

## 🐛 故障排除

### 找不到任何文件？
- 检查 WHERE 子句语法
- 尝试简单的查询：`findz '1'`
- 使用 `-L` 跟随符号链接

### 压缩包不工作？
```bash
# 安装完整支持
pip install -e ".[full]"
```

### 性能太慢？
- 使用 `-n` 禁用压缩包扫描
- 缩小搜索路径范围
- 使用更具体的过滤器

## ✨ 总结

新版 findz 提供了：
- ✅ **Typer** 驱动的现代 CLI
- ✅ **Rich** 美化的终端输出
- ✅ **交互模式**让查询构建更简单
- ✅ 保持与原 zfind 的完全兼容
- ✅ 更友好的用户体验

立即尝试：
```bash
findz
```

开始你的文件搜索之旅！🚀
